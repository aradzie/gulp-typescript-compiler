var S_UNDEFINED = 'undefined', S_STRING = 'string', S_NUMBER = 'number', S_BOOLEAN = 'boolean', S_OBJECT = 'object', S_FUNCTION = 'function';
exports.isUndefined = function (value) {
    var a = arguments, l = a.length;
    if (l > 1) {
        for (var n = 0; n < l; n++) {
            if (typeof a[n] != S_UNDEFINED) {
                return false;
            }
        }
        return true;
    }
    else {
        return typeof value == S_UNDEFINED;
    }
};
exports.isString = function (value) {
    var a = arguments, l = a.length;
    if (l > 1) {
        for (var n = 0; n < l; n++) {
            if (typeof a[n] != S_STRING) {
                return false;
            }
        }
        return true;
    }
    else {
        return typeof value == S_STRING;
    }
};
exports.isNumber = function (value) {
    var a = arguments, l = a.length;
    if (l > 1) {
        for (var n = 0; n < l; n++) {
            if (typeof a[n] != S_NUMBER) {
                return false;
            }
        }
        return true;
    }
    else {
        return typeof value == S_NUMBER;
    }
};
exports.isBoolean = function (value) {
    var a = arguments, l = a.length;
    if (l > 1) {
        for (var n = 0; n < l; n++) {
            if (typeof a[n] != S_BOOLEAN) {
                return false;
            }
        }
        return true;
    }
    else {
        return typeof value == S_BOOLEAN;
    }
};
exports.isObject = function (value) {
    var a = arguments, l = a.length;
    if (l > 1) {
        for (var n = 0; n < l; n++) {
            var o = a[n];
            if (!(o != null && typeof o == S_OBJECT && !Array.isArray(o))) {
                return false;
            }
        }
        return true;
    }
    else {
        return value != null && typeof value == S_OBJECT && !Array.isArray(value);
    }
};
exports.isFunction = function (value) {
    var a = arguments, l = a.length;
    if (l > 1) {
        for (var n = 0; n < l; n++) {
            if (typeof a[n] != S_FUNCTION) {
                return false;
            }
        }
        return true;
    }
    else {
        return typeof value == S_FUNCTION;
    }
};
/**
 * Returns an array of property name/value pairs.
 * @param map A map object.
 * @returns An array of property name/value pairs.
 */
function properties(map) {
    var result = [];
    forEach(map, function (key, value) {
        result.push({ name: key, value: value });
    });
    return result;
}
exports.properties = properties;
/**
 * Returns array of object property values.
 * @param map A map object.
 * @returns An array of property values.
 */
function values(map) {
    var result = [];
    forEach(map, function (key, value) {
        result.push(value);
    });
    return result;
}
exports.values = values;
/**
 * Convert a list of objects to a map.
 * @param list A list of objects with a specified grouping property.
 * @param name Grouping property name.
 * @returns A map of objects grouped by the key value.
 */
function groupBy(list, name) {
    var result = Object.create(null);
    for (var _i = 0; _i < list.length; _i++) {
        var value = list[_i];
        result[value[name]] = value;
    }
    return result;
}
exports.groupBy = groupBy;
/**
 * Convert a list of objects to a map.
 * @param list A list of objects with a specified grouping property.
 * @param name Grouping property name.
 * @returns A map of objects grouped by the key value.
 */
function groupByAppend(list, name) {
    var result = Object.create(null);
    for (var _i = 0; _i < list.length; _i++) {
        var value = list[_i];
        var key = value[name];
        if (key in result) {
            result[key].push(value);
        }
        else {
            result[key] = [value];
        }
    }
    return result;
}
exports.groupByAppend = groupByAppend;
/**
 * Creates a new naked object, and copies own properties from the specified map, if any.
 * A naked object is an object without prototype.
 * @param map A map of properties to copy to the naked object.
 * @returns A new naked object instance.
 */
function naked(map) {
    var result = Object.create(null);
    if (exports.isObject(map)) {
        for (var name_1 in map) {
            if (Object.prototype.hasOwnProperty.call(map, name_1)) {
                result[name_1] = map[name_1];
            }
        }
    }
    return result;
}
exports.naked = naked;
function forEach(map, fn, thisArg) {
    Object.keys(map).forEach(function (key, index) {
        fn.call(thisArg, key, map[key], index, map);
    });
}
exports.forEach = forEach;
function every(map, fn, thisArg) {
    return Object.keys(map).every(function (key, index) {
        return fn.call(thisArg, key, map[key], index, map);
    });
}
exports.every = every;
function some(map, fn, thisArg) {
    return Object.keys(map).some(function (key, index) {
        return fn.call(thisArg, key, map[key], index, map);
    });
}
exports.some = some;
function map(map, fn, thisArg) {
    return mapTo(map, fn, Object.create(Object.getPrototypeOf(map)), thisArg);
}
exports.map = map;
function mapTo(map, fn, to, thisArg) {
    Object.keys(map).forEach(function (key, index) {
        to[key] = fn.call(thisArg, key, map[key], index, map);
    });
    return to;
}
exports.mapTo = mapTo;
function filter(map, fn, thisArg) {
    return filterTo(map, fn, Object.create(Object.getPrototypeOf(map)), thisArg);
}
exports.filter = filter;
function filterTo(map, fn, to, thisArg) {
    Object.keys(map).forEach(function (key, index) {
        if (fn.call(thisArg, key, map[key], index, map)) {
            to[key] = map[key];
        }
    });
    return to;
}
exports.filterTo = filterTo;
function clone(source) {
    var result = Object.create(Object.getPrototypeOf(source));
    Object.getOwnPropertyNames(source).forEach(function (name) {
        Object.defineProperty(result, name, Object.getOwnPropertyDescriptor(source, name));
    });
    return result;
}
exports.clone = clone;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFuZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxhbmcudHMiXSwibmFtZXMiOlsicHJvcGVydGllcyIsInZhbHVlcyIsImdyb3VwQnkiLCJncm91cEJ5QXBwZW5kIiwibmFrZWQiLCJmb3JFYWNoIiwiZXZlcnkiLCJzb21lIiwibWFwIiwibWFwVG8iLCJmaWx0ZXIiLCJmaWx0ZXJUbyIsImNsb25lIl0sIm1hcHBpbmdzIjoiQUFJQSxJQUFNLFdBQVcsR0FBRyxXQUFXLEVBQzNCLFFBQVEsR0FBRyxRQUFRLEVBQ25CLFFBQVEsR0FBRyxRQUFRLEVBQ25CLFNBQVMsR0FBRyxTQUFTLEVBQ3JCLFFBQVEsR0FBRyxRQUFRLEVBQ25CLFVBQVUsR0FBRyxVQUFVLENBQUM7QUFNZixtQkFBVyxHQUFjLFVBQVUsS0FBSztJQUNqRCxJQUFJLENBQUMsR0FBRyxTQUFTLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDaEMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDUixHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDekIsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQztnQkFDN0IsTUFBTSxDQUFDLEtBQUssQ0FBQztZQUNqQixDQUFDO1FBQ0wsQ0FBQztRQUNELE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUNELElBQUksQ0FBQyxDQUFDO1FBQ0YsTUFBTSxDQUFDLE9BQU8sS0FBSyxJQUFJLFdBQVcsQ0FBQztJQUN2QyxDQUFDO0FBQ0wsQ0FBQyxDQUFDO0FBRVcsZ0JBQVEsR0FBYyxVQUFVLEtBQUs7SUFDOUMsSUFBSSxDQUFDLEdBQUcsU0FBUyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxD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QTtRQUNoQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsS0FBS0EsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDOUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ3ZCQSxDQUFDQTtJQUNMQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNIQSxNQUFNQSxDQUFDQSxFQUFFQSxDQUFDQTtBQUNkQSxDQUFDQTtBQVBlLGdCQUFRLFdBT3ZCLENBQUE7QUFFRCxlQUF3QyxNQUFTO0lBQzdDQyxJQUFJQSxNQUFNQSxHQUFHQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQSxjQUFjQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUMxREEsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxPQUFPQSxDQUFDQSxVQUFDQSxJQUFJQTtRQUM1Q0EsTUFBTUEsQ0FBQ0EsY0FBY0EsQ0FBQ0EsTUFBTUEsRUFBRUEsSUFBSUEsRUFBRUEsTUFBTUEsQ0FBQ0Esd0JBQXdCQSxDQUFDQSxNQUFNQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUN2RkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFDSEEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7QUFDbEJBLENBQUNBO0FBTmUsYUFBSyxRQU1wQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBNYXA8VD4ge1xuICAgIFtuYW1lOiBzdHJpbmddOiBUO1xufVxuXG5jb25zdCBTX1VOREVGSU5FRCA9ICd1bmRlZmluZWQnLFxuICAgIFNfU1RSSU5HID0gJ3N0cmluZycsXG4gICAgU19OVU1CRVIgPSAnbnVtYmVyJyxcbiAgICBTX0JPT0xFQU4gPSAnYm9vbGVhbicsXG4gICAgU19PQkpFQ1QgPSAnb2JqZWN0JyxcbiAgICBTX0ZVTkNUSU9OID0gJ2Z1bmN0aW9uJztcblxuZXhwb3J0IGludGVyZmFjZSBUeXBlQ2hlY2sge1xuICAgICh2YWx1ZTogYW55LCAuLi5yZXN0OiBhbnlbXSk6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBpc1VuZGVmaW5lZDogVHlwZUNoZWNrID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgbGV0IGEgPSBhcmd1bWVudHMsIGwgPSBhLmxlbmd0aDtcbiAgICBpZiAobCA+IDEpIHtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCBsOyBuKyspIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYVtuXSAhPSBTX1VOREVGSU5FRCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gU19VTkRFRklORUQ7XG4gICAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGlzU3RyaW5nOiBUeXBlQ2hlY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICBsZXQgYSA9IGFyZ3VtZW50cywgbCA9IGEubGVuZ3RoO1xuICAgIGlmIChsID4gMSkge1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGw7IG4rKykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBhW25dICE9IFNfU1RSSU5HKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSBTX1NUUklORztcbiAgICB9XG59O1xuXG5leHBvcnQgY29uc3QgaXNOdW1iZXI6IFR5cGVDaGVjayA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIGxldCBhID0gYXJndW1lbnRzLCBsID0gYS5sZW5ndGg7XG4gICAgaWYgKGwgPiAxKSB7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgbDsgbisrKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGFbbl0gIT0gU19OVU1CRVIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09IFNfTlVNQkVSO1xuICAgIH1cbn07XG5cbmV4cG9ydCBjb25zdCBpc0Jvb2xlYW46IFR5cGVDaGVjayA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIGxldCBhID0gYXJndW1lbnRzLCBsID0gYS5sZW5ndGg7XG4gICAgaWYgKGwgPiAxKSB7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgbDsgbisrKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGFbbl0gIT0gU19CT09MRUFOKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSBTX0JPT0xFQU47XG4gICAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGlzT2JqZWN0OiBUeXBlQ2hlY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICBsZXQgYSA9IGFyZ3VtZW50cywgbCA9IGEubGVuZ3RoO1xuICAgIGlmIChsID4gMSkge1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGw7IG4rKykge1xuICAgICAgICAgICAgbGV0IG8gPSBhW25dO1xuICAgICAgICAgICAgaWYgKCEobyAhPSBudWxsICYmIHR5cGVvZiBvID09IFNfT0JKRUNUICYmICFBcnJheS5pc0FycmF5KG8pKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PSBTX09CSkVDVCAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG4gICAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGlzRnVuY3Rpb246IFR5cGVDaGVjayA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIGxldCBhID0gYXJndW1lbnRzLCBsID0gYS5sZW5ndGg7XG4gICAgaWYgKGwgPiAxKSB7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgbDsgbisrKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGFbbl0gIT0gU19GVU5DVElPTikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gU19GVU5DVElPTjtcbiAgICB9XG59O1xuXG4vKipcbiAqIFJldHVybnMgYW4gYXJyYXkgb2YgcHJvcGVydHkgbmFtZS92YWx1ZSBwYWlycy5cbiAqIEBwYXJhbSBtYXAgQSBtYXAgb2JqZWN0LlxuICogQHJldHVybnMgQW4gYXJyYXkgb2YgcHJvcGVydHkgbmFtZS92YWx1ZSBwYWlycy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHByb3BlcnRpZXM8VD4obWFwOiBPYmplY3QpOiB7IG5hbWU6IHN0cmluZzsgdmFsdWU6IFQ7IH1bXSB7XG4gICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgIGZvckVhY2gobWFwLCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgICAgICByZXN1bHQucHVzaCh7IG5hbWU6IGtleSwgdmFsdWU6IHZhbHVlIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogUmV0dXJucyBhcnJheSBvZiBvYmplY3QgcHJvcGVydHkgdmFsdWVzLlxuICogQHBhcmFtIG1hcCBBIG1hcCBvYmplY3QuXG4gKiBAcmV0dXJucyBBbiBhcnJheSBvZiBwcm9wZXJ0eSB2YWx1ZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWx1ZXM8VD4obWFwOiBPYmplY3QpOiBUW10ge1xuICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICBmb3JFYWNoKG1hcCwgKGtleSwgdmFsdWUpID0+IHtcbiAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogQ29udmVydCBhIGxpc3Qgb2Ygb2JqZWN0cyB0byBhIG1hcC5cbiAqIEBwYXJhbSBsaXN0IEEgbGlzdCBvZiBvYmplY3RzIHdpdGggYSBzcGVjaWZpZWQgZ3JvdXBpbmcgcHJvcGVydHkuXG4gKiBAcGFyYW0gbmFtZSBHcm91cGluZyBwcm9wZXJ0eSBuYW1lLlxuICogQHJldHVybnMgQSBtYXAgb2Ygb2JqZWN0cyBncm91cGVkIGJ5IHRoZSBrZXkgdmFsdWUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBncm91cEJ5PFQ+KGxpc3Q6IFRbXSwgbmFtZTogc3RyaW5nKTogTWFwPFQ+IHtcbiAgICBsZXQgcmVzdWx0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICBmb3IgKGxldCB2YWx1ZSBvZiBsaXN0KSB7XG4gICAgICAgIHJlc3VsdFt2YWx1ZVtuYW1lXV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBDb252ZXJ0IGEgbGlzdCBvZiBvYmplY3RzIHRvIGEgbWFwLlxuICogQHBhcmFtIGxpc3QgQSBsaXN0IG9mIG9iamVjdHMgd2l0aCBhIHNwZWNpZmllZCBncm91cGluZyBwcm9wZXJ0eS5cbiAqIEBwYXJhbSBuYW1lIEdyb3VwaW5nIHByb3BlcnR5IG5hbWUuXG4gKiBAcmV0dXJucyBBIG1hcCBvZiBvYmplY3RzIGdyb3VwZWQgYnkgdGhlIGtleSB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwQnlBcHBlbmQ8VD4obGlzdDogVFtdLCBuYW1lOiBzdHJpbmcpOiBNYXA8VFtdPiB7XG4gICAgbGV0IHJlc3VsdCA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgZm9yIChsZXQgdmFsdWUgb2YgbGlzdCkge1xuICAgICAgICBsZXQga2V5ID0gdmFsdWVbbmFtZV07XG4gICAgICAgIGlmIChrZXkgaW4gcmVzdWx0KSB7XG4gICAgICAgICAgICByZXN1bHRba2V5XS5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gW3ZhbHVlXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgbmFrZWQgb2JqZWN0LCBhbmQgY29waWVzIG93biBwcm9wZXJ0aWVzIGZyb20gdGhlIHNwZWNpZmllZCBtYXAsIGlmIGFueS5cbiAqIEEgbmFrZWQgb2JqZWN0IGlzIGFuIG9iamVjdCB3aXRob3V0IHByb3RvdHlwZS5cbiAqIEBwYXJhbSBtYXAgQSBtYXAgb2YgcHJvcGVydGllcyB0byBjb3B5IHRvIHRoZSBuYWtlZCBvYmplY3QuXG4gKiBAcmV0dXJucyBBIG5ldyBuYWtlZCBvYmplY3QgaW5zdGFuY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBuYWtlZDxUPihtYXA/OiBUKTogVCB7XG4gICAgbGV0IHJlc3VsdCA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgaWYgKGlzT2JqZWN0KG1hcCkpIHtcbiAgICAgICAgZm9yIChsZXQgbmFtZSBpbiBtYXApIHtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobWFwLCBuYW1lKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtuYW1lXSA9IG1hcFtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9yRWFjaDxUIGV4dGVuZHMgT2JqZWN0PihtYXA6IFQsIGZuOiAoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnksIGluZGV4OiBudW1iZXIsIG1hcDogVCkgPT4gdm9pZCwgdGhpc0FyZz86IGFueSk6IHZvaWQge1xuICAgIE9iamVjdC5rZXlzKG1hcCkuZm9yRWFjaCgoa2V5LCBpbmRleCkgPT4ge1xuICAgICAgICBmbi5jYWxsKHRoaXNBcmcsIGtleSwgbWFwW2tleV0sIGluZGV4LCBtYXApO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXZlcnk8VCBleHRlbmRzIE9iamVjdD4obWFwOiBULCBmbjogKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyLCBtYXA6IFQpID0+IGJvb2xlYW4sIHRoaXNBcmc/OiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMobWFwKS5ldmVyeSgoa2V5LCBpbmRleCkgPT4ge1xuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzQXJnLCBrZXksIG1hcFtrZXldLCBpbmRleCwgbWFwKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvbWU8VCBleHRlbmRzIE9iamVjdD4obWFwOiBULCBmbjogKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyLCBtYXA6IFQpID0+IGJvb2xlYW4sIHRoaXNBcmc/OiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMobWFwKS5zb21lKChrZXksIGluZGV4KSA9PiB7XG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXNBcmcsIGtleSwgbWFwW2tleV0sIGluZGV4LCBtYXApO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFwPFQgZXh0ZW5kcyBPYmplY3Q+KG1hcDogVCwgZm46IChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgaW5kZXg6IG51bWJlciwgbWFwOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpOiBUIHtcbiAgICByZXR1cm4gbWFwVG8obWFwLCBmbiwgT2JqZWN0LmNyZWF0ZShPYmplY3QuZ2V0UHJvdG90eXBlT2YobWFwKSksIHRoaXNBcmcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFwVG88VCBleHRlbmRzIE9iamVjdD4obWFwOiBULCBmbjogKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyLCBtYXA6IFQpID0+IGFueSwgdG86IFQsIHRoaXNBcmc/OiBhbnkpOiBUIHtcbiAgICBPYmplY3Qua2V5cyhtYXApLmZvckVhY2goKGtleSwgaW5kZXgpID0+IHtcbiAgICAgICAgdG9ba2V5XSA9IGZuLmNhbGwodGhpc0FyZywga2V5LCBtYXBba2V5XSwgaW5kZXgsIG1hcCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyPFQgZXh0ZW5kcyBPYmplY3Q+KG1hcDogVCwgZm46IChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgaW5kZXg6IG51bWJlciwgbWFwOiBUKSA9PiBib29sZWFuLCB0aGlzQXJnPzogYW55KTogVCB7XG4gICAgcmV0dXJuIGZpbHRlclRvKG1hcCwgZm4sIE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKG1hcCkpLCB0aGlzQXJnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlclRvPFQgZXh0ZW5kcyBPYmplY3Q+KG1hcDogVCwgZm46IChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgaW5kZXg6IG51bWJlciwgbWFwOiBUKSA9PiBib29sZWFuLCB0bzogVCwgdGhpc0FyZz86IGFueSk6IFQge1xuICAgIE9iamVjdC5rZXlzKG1hcCkuZm9yRWFjaCgoa2V5LCBpbmRleCkgPT4ge1xuICAgICAgICBpZiAoZm4uY2FsbCh0aGlzQXJnLCBrZXksIG1hcFtrZXldLCBpbmRleCwgbWFwKSkge1xuICAgICAgICAgICAgdG9ba2V5XSA9IG1hcFtrZXldO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xvbmU8VCBleHRlbmRzIE9iamVjdD4oc291cmNlOiBUKTogVCB7XG4gICAgbGV0IHJlc3VsdCA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHNvdXJjZSkpO1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHNvdXJjZSkuZm9yRWFjaCgobmFtZSkgPT4ge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVzdWx0LCBuYW1lLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwgbmFtZSkpO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4iXX0=