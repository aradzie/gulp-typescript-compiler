var S_UNDEFINED = 'undefined', S_STRING = 'string', S_NUMBER = 'number', S_BOOLEAN = 'boolean', S_OBJECT = 'object', S_FUNCTION = 'function';
function isUndefined(value) {
    return typeof value === S_UNDEFINED;
}
exports.isUndefined = isUndefined;
function isString(value) {
    return typeof value === S_STRING;
}
exports.isString = isString;
function isNumber(value) {
    return typeof value === S_NUMBER;
}
exports.isNumber = isNumber;
function isBoolean(value) {
    return typeof value === S_BOOLEAN;
}
exports.isBoolean = isBoolean;
function isObject(value) {
    return value !== null && typeof value === S_OBJECT && !Array.isArray(value);
}
exports.isObject = isObject;
function isFunction(value) {
    return typeof value === S_FUNCTION;
}
exports.isFunction = isFunction;
/**
 * Returns an array of property name/value pairs.
 * @param map A map object.
 * @returns An array of property name/value pairs.
 */
function properties(map) {
    var result = [];
    forEach(map, function (key, value) {
        result.push({ name: key, value: value });
    });
    return result;
}
exports.properties = properties;
/**
 * Returns array of object property values.
 * @param map A map object.
 * @returns An array of property values.
 */
function values(map) {
    var result = [];
    forEach(map, function (key, value) {
        result.push(value);
    });
    return result;
}
exports.values = values;
/**
 * Convert a list of objects to a map.
 * @param list A list of objects with a specified grouping property.
 * @param name Grouping property name.
 * @returns A map of objects grouped by the key value.
 */
function groupBy(list, name) {
    var result = Object.create(null);
    for (var _i = 0; _i < list.length; _i++) {
        var value = list[_i];
        result[value[name]] = value;
    }
    return result;
}
exports.groupBy = groupBy;
/**
 * Creates a new naked object, and copies own properties from the specified map, if any.
 * A naked object is an object without prototype.
 * @param map A map of properties to copy to the naked object.
 * @returns A new naked object instance.
 */
function naked(map) {
    var result = Object.create(null);
    if (isObject(map)) {
        for (var name_1 in map) {
            if (Object.prototype.hasOwnProperty.call(map, name_1)) {
                result[name_1] = map[name_1];
            }
        }
    }
    return result;
}
exports.naked = naked;
function forEach(map, fn, thisArg) {
    Object.keys(map).forEach(function (key, index) {
        fn.call(thisArg, key, map[key], index, map);
    });
}
exports.forEach = forEach;
function every(map, fn, thisArg) {
    return Object.keys(map).every(function (key, index) {
        return fn.call(thisArg, key, map[key], index, map);
    });
}
exports.every = every;
function some(map, fn, thisArg) {
    return Object.keys(map).some(function (key, index) {
        return fn.call(thisArg, key, map[key], index, map);
    });
}
exports.some = some;
function map(map, fn, thisArg) {
    return mapTo(map, fn, Object.create(Object.getPrototypeOf(map)), thisArg);
}
exports.map = map;
function mapTo(map, fn, to, thisArg) {
    Object.keys(map).forEach(function (key, index) {
        to[key] = fn.call(thisArg, key, map[key], index, map);
    });
    return to;
}
exports.mapTo = mapTo;
function filter(map, fn, thisArg) {
    return filterTo(map, fn, Object.create(Object.getPrototypeOf(map)), thisArg);
}
exports.filter = filter;
function filterTo(map, fn, to, thisArg) {
    Object.keys(map).forEach(function (key, index) {
        if (fn.call(thisArg, key, map[key], index, map)) {
            to[key] = map[key];
        }
    });
    return to;
}
exports.filterTo = filterTo;
function clone(source) {
    var result = Object.create(Object.getPrototypeOf(source));
    Object.getOwnPropertyNames(source).forEach(function (name) {
        Object.defineProperty(result, name, Object.getOwnPropertyDescriptor(source, name));
    });
    return result;
}
exports.clone = clone;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFuZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxhbmcudHMiXSwibmFtZXMiOlsiaXNVbmRlZmluZWQiLCJpc1N0cmluZyIsImlzTnVtYmVyIiwiaXNCb29sZWFuIiwiaXNPYmplY3QiLCJpc0Z1bmN0aW9uIiwicHJvcGVydGllcyIsInZhbHVlcyIsImdyb3VwQnkiLCJuYWtlZCIsImZvckVhY2giLCJldmVyeSIsInNvbWUiLCJtYXAiLCJtYXBUbyIsImZpbHRlciIsImZpbHRlclRvIiwiY2xvbmUiXSwibWFwcGluZ3MiOiJBQUlBLElBQU0sV0FBVyxHQUFHLFdBQVcsRUFDM0IsUUFBUSxHQUFHLFFBQVEsRUFDbkIsUUFBUSxHQUFHLFFBQVEsRUFDbkIsU0FBUyxHQUFHLFNBQVMsRUFDckIsUUFBUSxHQUFHLFFBQVEsRUFDbkIsVUFBVSxHQUFHLFVBQVUsQ0FBQztBQUU1QixxQkFBNEIsS0FBSztJQUM3QkEsTUFBTUEsQ0FBQ0EsT0FBT0EsS0FBS0EsS0FBS0EsV0FBV0EsQ0FBQ0E7QUFDeENBLENBQUNBO0FBRmUsbUJBQVcsY0FFMUIsQ0FBQTtBQUVELGtCQUF5QixLQUFLO0lBQzFCQyxNQUFNQSxDQUFDQSxPQUFPQSxLQUFLQSxLQUFLQSxRQUFRQSxDQUFDQTtBQUNyQ0EsQ0FBQ0E7QUFGZSxnQkFBUSxXQUV2QixDQUFBO0FBRUQsa0JBQXlCLEtBQUs7SUFDMUJDLE1BQU1BLENBQUNBLE9BQU9BLEtBQUtBLEtBQUtBLFFBQVFBLENBQUNBO0FBQ3JDQSxDQUFDQTtBQUZlLGdCQUFRLFdBRXZCLENBQUE7QUFFRCxtQkFBMEIsS0FBSztJQUMzQkMsTUFBTUEsQ0FBQ0EsT0FBT0EsS0FBS0EsS0FBS0EsU0FBU0EsQ0FBQ0E7QUFDdENBLENBQUNBO0FBRmUsaUJBQVMsWUFFeEIsQ0FBQTtBQUVELGtCQUF5QixLQUFLO0lBQzFCQyxNQUFNQSxDQUFDQSxLQUFLQSxLQUFLQSxJQUFJQSxJQUFJQSxPQUFPQSxLQUFLQSxLQUFLQSxRQUFRQSxJQUFJQSxD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QUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUM5Q0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDdkJBLENBQUNBO0lBQ0xBLENBQUNBLENBQUNBLENBQUNBO0lBQ0hBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBO0FBQ2RBLENBQUNBO0FBUGUsZ0JBQVEsV0FPdkIsQ0FBQTtBQUVELGVBQXdDLE1BQVM7SUFDN0NDLElBQUlBLE1BQU1BLEdBQUdBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBLGNBQWNBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO0lBQzFEQSxNQUFNQSxDQUFDQSxtQkFBbUJBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLFVBQUNBLElBQUlBO1FBQzVDQSxNQUFNQSxDQUFDQSxjQUFjQSxDQUFDQSxNQUFNQSxFQUFFQSxJQUFJQSxFQUFFQSxNQUFNQSxDQUFDQSx3QkFBd0JBLENBQUNBLE1BQU1BLEVBQUVBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO0lBQ3ZGQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNIQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQTtBQUNsQkEsQ0FBQ0E7QUFOZSxhQUFLLFFBTXBCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIE1hcDxUPiB7XG4gICAgW25hbWU6IHN0cmluZ106IFQ7XG59XG5cbmNvbnN0IFNfVU5ERUZJTkVEID0gJ3VuZGVmaW5lZCcsXG4gICAgU19TVFJJTkcgPSAnc3RyaW5nJyxcbiAgICBTX05VTUJFUiA9ICdudW1iZXInLFxuICAgIFNfQk9PTEVBTiA9ICdib29sZWFuJyxcbiAgICBTX09CSkVDVCA9ICdvYmplY3QnLFxuICAgIFNfRlVOQ1RJT04gPSAnZnVuY3Rpb24nO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsdWUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBTX1VOREVGSU5FRDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3RyaW5nKHZhbHVlKTogdmFsdWUgaXMgc3RyaW5nIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBTX1NUUklORztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKTogdmFsdWUgaXMgbnVtYmVyIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBTX05VTUJFUjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQm9vbGVhbih2YWx1ZSk6IHZhbHVlIGlzIGJvb2xlYW4ge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFNfQk9PTEVBTjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKTogdmFsdWUgaXMgT2JqZWN0IHtcbiAgICByZXR1cm4gdmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSBTX09CSkVDVCAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKTogdmFsdWUgaXMgRnVuY3Rpb24ge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFNfRlVOQ1RJT047XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lL3ZhbHVlIHBhaXJzLlxuICogQHBhcmFtIG1hcCBBIG1hcCBvYmplY3QuXG4gKiBAcmV0dXJucyBBbiBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lL3ZhbHVlIHBhaXJzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcHJvcGVydGllczxUPihtYXA6IE9iamVjdCk6IHsgbmFtZTogc3RyaW5nOyB2YWx1ZTogVDsgfVtdIHtcbiAgICBsZXQgcmVzdWx0ID0gW107XG4gICAgZm9yRWFjaChtYXAsIChrZXksIHZhbHVlKSA9PiB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHsgbmFtZToga2V5LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFycmF5IG9mIG9iamVjdCBwcm9wZXJ0eSB2YWx1ZXMuXG4gKiBAcGFyYW0gbWFwIEEgbWFwIG9iamVjdC5cbiAqIEByZXR1cm5zIEFuIGFycmF5IG9mIHByb3BlcnR5IHZhbHVlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbHVlczxUPihtYXA6IE9iamVjdCk6IFRbXSB7XG4gICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgIGZvckVhY2gobWFwLCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBDb252ZXJ0IGEgbGlzdCBvZiBvYmplY3RzIHRvIGEgbWFwLlxuICogQHBhcmFtIGxpc3QgQSBsaXN0IG9mIG9iamVjdHMgd2l0aCBhIHNwZWNpZmllZCBncm91cGluZyBwcm9wZXJ0eS5cbiAqIEBwYXJhbSBuYW1lIEdyb3VwaW5nIHByb3BlcnR5IG5hbWUuXG4gKiBAcmV0dXJucyBBIG1hcCBvZiBvYmplY3RzIGdyb3VwZWQgYnkgdGhlIGtleSB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwQnk8VD4obGlzdDogVFtdLCBuYW1lOiBzdHJpbmcpOiBNYXA8VD4ge1xuICAgIGxldCByZXN1bHQgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgIGZvciAobGV0IHZhbHVlIG9mIGxpc3QpIHtcbiAgICAgICAgcmVzdWx0W3ZhbHVlW25hbWVdXSA9IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgbmFrZWQgb2JqZWN0LCBhbmQgY29waWVzIG93biBwcm9wZXJ0aWVzIGZyb20gdGhlIHNwZWNpZmllZCBtYXAsIGlmIGFueS5cbiAqIEEgbmFrZWQgb2JqZWN0IGlzIGFuIG9iamVjdCB3aXRob3V0IHByb3RvdHlwZS5cbiAqIEBwYXJhbSBtYXAgQSBtYXAgb2YgcHJvcGVydGllcyB0byBjb3B5IHRvIHRoZSBuYWtlZCBvYmplY3QuXG4gKiBAcmV0dXJucyBBIG5ldyBuYWtlZCBvYmplY3QgaW5zdGFuY2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBuYWtlZDxUPihtYXA/OiBUKTogVCB7XG4gICAgbGV0IHJlc3VsdCA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgaWYgKGlzT2JqZWN0KG1hcCkpIHtcbiAgICAgICAgZm9yIChsZXQgbmFtZSBpbiBtYXApIHtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobWFwLCBuYW1lKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtuYW1lXSA9IG1hcFtuYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9yRWFjaDxUIGV4dGVuZHMgT2JqZWN0PihtYXA6IFQsIGZuOiAoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnksIGluZGV4OiBudW1iZXIsIG1hcDogVCkgPT4gdm9pZCwgdGhpc0FyZz86IGFueSk6IHZvaWQge1xuICAgIE9iamVjdC5rZXlzKG1hcCkuZm9yRWFjaCgoa2V5LCBpbmRleCkgPT4ge1xuICAgICAgICBmbi5jYWxsKHRoaXNBcmcsIGtleSwgbWFwW2tleV0sIGluZGV4LCBtYXApO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXZlcnk8VCBleHRlbmRzIE9iamVjdD4obWFwOiBULCBmbjogKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyLCBtYXA6IFQpID0+IGJvb2xlYW4sIHRoaXNBcmc/OiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMobWFwKS5ldmVyeSgoa2V5LCBpbmRleCkgPT4ge1xuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzQXJnLCBrZXksIG1hcFtrZXldLCBpbmRleCwgbWFwKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvbWU8VCBleHRlbmRzIE9iamVjdD4obWFwOiBULCBmbjogKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyLCBtYXA6IFQpID0+IGJvb2xlYW4sIHRoaXNBcmc/OiBhbnkpOiBib29sZWFuIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMobWFwKS5zb21lKChrZXksIGluZGV4KSA9PiB7XG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXNBcmcsIGtleSwgbWFwW2tleV0sIGluZGV4LCBtYXApO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFwPFQgZXh0ZW5kcyBPYmplY3Q+KG1hcDogVCwgZm46IChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgaW5kZXg6IG51bWJlciwgbWFwOiBUKSA9PiBhbnksIHRoaXNBcmc/OiBhbnkpOiBUIHtcbiAgICByZXR1cm4gbWFwVG8obWFwLCBmbiwgT2JqZWN0LmNyZWF0ZShPYmplY3QuZ2V0UHJvdG90eXBlT2YobWFwKSksIHRoaXNBcmcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFwVG88VCBleHRlbmRzIE9iamVjdD4obWFwOiBULCBmbjogKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyLCBtYXA6IFQpID0+IGFueSwgdG86IFQsIHRoaXNBcmc/OiBhbnkpOiBUIHtcbiAgICBPYmplY3Qua2V5cyhtYXApLmZvckVhY2goKGtleSwgaW5kZXgpID0+IHtcbiAgICAgICAgdG9ba2V5XSA9IGZuLmNhbGwodGhpc0FyZywga2V5LCBtYXBba2V5XSwgaW5kZXgsIG1hcCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyPFQgZXh0ZW5kcyBPYmplY3Q+KG1hcDogVCwgZm46IChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgaW5kZXg6IG51bWJlciwgbWFwOiBUKSA9PiBib29sZWFuLCB0aGlzQXJnPzogYW55KTogVCB7XG4gICAgcmV0dXJuIGZpbHRlclRvKG1hcCwgZm4sIE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKG1hcCkpLCB0aGlzQXJnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlclRvPFQgZXh0ZW5kcyBPYmplY3Q+KG1hcDogVCwgZm46IChrZXk6IHN0cmluZywgdmFsdWU6IGFueSwgaW5kZXg6IG51bWJlciwgbWFwOiBUKSA9PiBib29sZWFuLCB0bzogVCwgdGhpc0FyZz86IGFueSk6IFQge1xuICAgIE9iamVjdC5rZXlzKG1hcCkuZm9yRWFjaCgoa2V5LCBpbmRleCkgPT4ge1xuICAgICAgICBpZiAoZm4uY2FsbCh0aGlzQXJnLCBrZXksIG1hcFtrZXldLCBpbmRleCwgbWFwKSkge1xuICAgICAgICAgICAgdG9ba2V5XSA9IG1hcFtrZXldO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xvbmU8VCBleHRlbmRzIE9iamVjdD4oc291cmNlOiBUKTogVCB7XG4gICAgbGV0IHJlc3VsdCA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHNvdXJjZSkpO1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHNvdXJjZSkuZm9yRWFjaCgobmFtZSkgPT4ge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmVzdWx0LCBuYW1lLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwgbmFtZSkpO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4iXX0=