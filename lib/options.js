var _ts = require('typescript');
var _adapter = require('./adapter');
var _lang = require('./lang');
var optionsList = [
    {
        name: 'charset',
        type: 'string',
    },
    {
        name: 'declaration',
        type: 'boolean',
    },
    {
        name: 'diagnostics',
        type: 'boolean',
    },
    {
        name: 'emitBOM',
        type: 'boolean'
    },
    {
        name: 'emitDecoratorMetadata',
        type: 'boolean',
        experimental: true,
    },
    {
        name: 'experimentalAsyncFunctions',
        type: 'boolean',
    },
    {
        name: 'experimentalDecorators',
        type: 'boolean',
    },
    {
        name: 'help',
        type: 'boolean',
    },
    {
        name: 'init',
        type: 'boolean',
    },
    {
        name: 'inlineSourceMap',
        type: 'boolean',
    },
    {
        name: 'inlineSources',
        type: 'boolean',
    },
    {
        name: 'isolatedModules',
        type: 'boolean',
    },
    {
        name: 'jsx',
        type: {
            'preserve': 1 /* Preserve */,
            'react': 2 /* React */,
        },
    },
    {
        name: 'listFiles',
        type: 'boolean',
    },
    {
        name: 'locale',
        type: 'string',
    },
    {
        name: 'mapRoot',
        type: 'string',
        isFilePath: true,
    },
    {
        name: 'module',
        type: {
            'commonjs': 1 /* CommonJS */,
            'amd': 2 /* AMD */,
            'system': 4 /* System */,
            'umd': 3 /* UMD */,
        },
    },
    {
        name: 'moduleResolution',
        type: {
            'node': 2 /* NodeJs */,
            'classic': 1 /* Classic */,
        },
    },
    {
        name: 'newLine',
        type: {
            'crlf': 0 /* CarriageReturnLineFeed */,
            'lf': 1 /* LineFeed */,
        },
    },
    {
        name: 'noEmit',
        type: 'boolean',
    },
    {
        name: 'noEmitHelpers',
        type: 'boolean',
    },
    {
        name: 'noEmitOnError',
        type: 'boolean',
    },
    {
        name: 'noImplicitAny',
        type: 'boolean',
    },
    {
        name: 'noLib',
        type: 'boolean',
    },
    {
        name: 'noResolve',
        type: 'boolean',
    },
    {
        name: 'outDir',
        type: 'string',
        isFilePath: true,
    },
    {
        name: 'outFile',
        type: 'string',
        isFilePath: true,
    },
    {
        name: 'preserveConstEnums',
        type: 'boolean',
    },
    {
        name: 'removeComments',
        type: 'boolean',
    },
    {
        name: 'rootDir',
        type: 'string',
        isFilePath: true,
    },
    {
        name: 'skipDefaultLibCheck',
        type: 'boolean',
    },
    {
        name: 'sourceMap',
        type: 'boolean',
    },
    {
        name: 'sourceRoot',
        type: 'string',
        isFilePath: true,
    },
    {
        name: 'suppressExcessPropertyErrors',
        type: 'boolean',
        experimental: true
    },
    {
        name: 'suppressImplicitAnyIndexErrors',
        type: 'boolean',
    },
    {
        name: 'stripInternal',
        type: 'boolean',
        experimental: true
    },
    {
        name: 'target',
        type: {
            'es3': 0 /* ES3 */,
            'es5': 1 /* ES5 */,
            'es6': 2 /* ES6 */,
        },
    },
];
var optionsMap = _lang.groupBy(optionsList, 'name');
var S_TYPESCRIPT = 'typescript';
function parseCompilerOptions(config, resolvePath, notifier) {
    var options = Object.create(null);
    _lang.forEach(config, function (name, value) {
        if (name in optionsMap) {
            var option = optionsMap[name];
            if (option.type === 'string') {
                if (!_lang.isString(value)) {
                    notifier.notify("Expected string value of the config property " + q(name));
                }
            }
            else if (option.type === 'number') {
                if (!_lang.isNumber(value)) {
                    notifier.notify("Expected number value of the config property " + q(name));
                }
            }
            else if (option.type === 'boolean') {
                if (!_lang.isBoolean(value)) {
                    notifier.notify("Expected boolean value of the config property " + q(name));
                }
            }
            else {
                if (value in option.type) {
                    value = option.type[value];
                }
                else {
                    notifier.notify(("Unknown value " + q(value) + " of the config property " + q(name) + ", ") +
                        ("expected one of " + Object.keys(option.type).map(q).join(', ')));
                }
            }
            if (option.isFilePath) {
                value = resolvePath(value);
            }
            options[name] = value;
        }
        else {
            if (name !== S_TYPESCRIPT) {
                notifier.notify("Unknown config property " + q(name));
            }
        }
    });
    if (options.rootDir == null) {
        options.rootDir = resolvePath('.');
    }
    return options;
    function q(s) {
        return "'" + s + "'";
    }
}
exports.parseCompilerOptions = parseCompilerOptions;
function loadAdapter(config) {
    if (S_TYPESCRIPT in config) {
        var ts = config[S_TYPESCRIPT];
        if (!_lang.isObject(ts) || !_lang.isString(ts.version)) {
            throw new Error("Invalid TypeScript opbect in the config property 'typescript'");
        }
        return _adapter.load(ts);
    }
    else {
        return _adapter.load(_ts);
    }
}
exports.loadAdapter = loadAdapter;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3B0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm9wdGlvbnMudHMiXSwibmFtZXMiOlsicGFyc2VDb21waWxlck9wdGlvbnMiLCJwYXJzZUNvbXBpbGVyT3B0aW9ucy5xIiwibG9hZEFkYXB0ZXIiXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sR0FBRyxXQUFXLFlBQVksQ0FBQyxDQUFDO0FBQ25DLElBQU8sUUFBUSxXQUFXLFdBQVcsQ0FBQyxDQUFDO0FBRXZDLElBQU8sS0FBSyxXQUFXLFFBQVEsQ0FBQyxDQUFDO0FBYWpDLElBQU0sV0FBVyxHQUFhO0lBQzFCO1FBQ0ksSUFBSSxFQUFFLFNBQVM7UUFDZixJQUFJLEVBQUUsUUFBUTtLQUNqQjtJQUNEO1FBQ0ksSUFBSSxFQUFFLGFBQWE7UUFDbkIsSUFBSSxFQUFFLFNBQVM7S0FDbEI7SUFDRDtRQUNJLElBQUksRUFBRSxhQUFhO1FBQ25CLElBQUksRUFBRSxTQUFTO0tBQ2xCO0lBQ0Q7UUFDSSxJQUFJLEVBQUUsU0FBUztRQUNmLElBQUksRUFBRSxTQUFTO0tBQ2xCO0lBQ0Q7UUFDSSxJQUFJLEVBQUUsdUJBQXVCO1FBQzdCLElBQUksRUFBRSxTQUFTO1FBQ2YsWUFBWSxFQUFFLElBQUk7S0FDckI7SUFDRDtRQUNJLElBQUksRUFBRSw0QkFBNEI7UUFDbEMsSUFBSSxFQUFFLFNBQVM7S0FDbEI7SUFDRDtRQUNJLElBQUksRUFBRSx3QkFBd0I7UUFDOUIsSUFBSSxFQUFFLFNBQVM7S0FDbEI7SUFDRDtRQUNJLElBQUksRUFBRSxNQUFNO1FBQ1osSUFBSSxFQUFFLFNBQVM7S0FDbEI7SUFDRDtRQUNJLElBQUksRUFBRSxNQUFNO1FBQ1osSUFBSSxFQUFFLFNBQVM7S0FDbEI7SUFDRDtRQUNJLElBQUksRUFBRSxpQkFBaUI7UUFDdkIsSUFBSSxFQUFFLFNBQVM7S0FDbEI7SUFDRDtRQUNJLElBQUksRUFBRSxlQUFlO1FBQ3JCLElBQUksRUFBRSxTQUFTO0tBQ2xCO0lBQ0Q7UUFDSSxJQUFJLEVB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QUFFQSxDQUFDQSxDQUFDQTtJQUM3QkEsQ0FBQ0E7SUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDRkEsTUFBTUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7SUFDOUJBLENBQUNBO0FBQ0xBLENBQUNBO0FBWGUsbUJBQVcsY0FXMUIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfdHMgPSByZXF1aXJlKCd0eXBlc2NyaXB0Jyk7XG5pbXBvcnQgX2FkYXB0ZXIgPSByZXF1aXJlKCcuL2FkYXB0ZXInKTtcbmltcG9ydCBfdXRpbCA9IHJlcXVpcmUoJy4vdXRpbCcpO1xuaW1wb3J0IF9sYW5nID0gcmVxdWlyZSgnLi9sYW5nJyk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzb2x2ZVBhdGgge1xuICAgIChwYXRoOiBzdHJpbmcpOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBPcHRpb24ge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0eXBlOiBzdHJpbmcgfCBfbGFuZy5NYXA8bnVtYmVyPjtcbiAgICBpc0ZpbGVQYXRoPzogYm9vbGVhbjtcbiAgICBleHBlcmltZW50YWw/OiBib29sZWFuO1xufVxuXG5jb25zdCBvcHRpb25zTGlzdDogT3B0aW9uW10gPSBbXG4gICAge1xuICAgICAgICBuYW1lOiAnY2hhcnNldCcsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnZGVjbGFyYXRpb24nLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdkaWFnbm9zdGljcycsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ2VtaXRCT00nLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbidcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ2VtaXREZWNvcmF0b3JNZXRhZGF0YScsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICAgICAgZXhwZXJpbWVudGFsOiB0cnVlLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnZXhwZXJpbWVudGFsQXN5bmNGdW5jdGlvbnMnLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdleHBlcmltZW50YWxEZWNvcmF0b3JzJyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnaGVscCcsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ2luaXQnLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdpbmxpbmVTb3VyY2VNYXAnLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdpbmxpbmVTb3VyY2VzJyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnaXNvbGF0ZWRNb2R1bGVzJyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnanN4JyxcbiAgICAgICAgdHlwZToge1xuICAgICAgICAgICAgJ3ByZXNlcnZlJzogX3RzLkpzeEVtaXQuUHJlc2VydmUsXG4gICAgICAgICAgICAncmVhY3QnOiBfdHMuSnN4RW1pdC5SZWFjdCxcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ2xpc3RGaWxlcycsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ2xvY2FsZScsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnbWFwUm9vdCcsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICBpc0ZpbGVQYXRoOiB0cnVlLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnbW9kdWxlJyxcbiAgICAgICAgdHlwZToge1xuICAgICAgICAgICAgJ2NvbW1vbmpzJzogX3RzLk1vZHVsZUtpbmQuQ29tbW9uSlMsXG4gICAgICAgICAgICAnYW1kJzogX3RzLk1vZHVsZUtpbmQuQU1ELFxuICAgICAgICAgICAgJ3N5c3RlbSc6IF90cy5Nb2R1bGVLaW5kLlN5c3RlbSxcbiAgICAgICAgICAgICd1bWQnOiBfdHMuTW9kdWxlS2luZC5VTUQsXG4gICAgICAgICAgICAvLydlczYnOiBfdHMuTW9kdWxlS2luZC5FUzYsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdtb2R1bGVSZXNvbHV0aW9uJyxcbiAgICAgICAgdHlwZToge1xuICAgICAgICAgICAgJ25vZGUnOiBfdHMuTW9kdWxlUmVzb2x1dGlvbktpbmQuTm9kZUpzLFxuICAgICAgICAgICAgJ2NsYXNzaWMnOiBfdHMuTW9kdWxlUmVzb2x1dGlvbktpbmQuQ2xhc3NpYyxcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ25ld0xpbmUnLFxuICAgICAgICB0eXBlOiB7XG4gICAgICAgICAgICAnY3JsZic6IF90cy5OZXdMaW5lS2luZC5DYXJyaWFnZVJldHVybkxpbmVGZWVkLFxuICAgICAgICAgICAgJ2xmJzogX3RzLk5ld0xpbmVLaW5kLkxpbmVGZWVkLFxuICAgICAgICB9LFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnbm9FbWl0JyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnbm9FbWl0SGVscGVycycsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ25vRW1pdE9uRXJyb3InLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdub0ltcGxpY2l0QW55JyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnbm9MaWInLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdub1Jlc29sdmUnLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdvdXREaXInLFxuICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgaXNGaWxlUGF0aDogdHJ1ZSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ291dEZpbGUnLFxuICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgaXNGaWxlUGF0aDogdHJ1ZSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ3ByZXNlcnZlQ29uc3RFbnVtcycsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ3JlbW92ZUNvbW1lbnRzJyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAncm9vdERpcicsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICBpc0ZpbGVQYXRoOiB0cnVlLFxuICAgIH0sXG5cbiAgICB7XG4gICAgICAgIG5hbWU6ICdza2lwRGVmYXVsdExpYkNoZWNrJyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnc291cmNlTWFwJyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnc291cmNlUm9vdCcsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICBpc0ZpbGVQYXRoOiB0cnVlLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAnc3VwcHJlc3NFeGNlc3NQcm9wZXJ0eUVycm9ycycsXG4gICAgICAgIHR5cGU6ICdib29sZWFuJyxcbiAgICAgICAgZXhwZXJpbWVudGFsOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdzdXBwcmVzc0ltcGxpY2l0QW55SW5kZXhFcnJvcnMnLFxuICAgICAgICB0eXBlOiAnYm9vbGVhbicsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdzdHJpcEludGVybmFsJyxcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLFxuICAgICAgICBleHBlcmltZW50YWw6IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ3RhcmdldCcsXG4gICAgICAgIHR5cGU6IHtcbiAgICAgICAgICAgICdlczMnOiBfdHMuU2NyaXB0VGFyZ2V0LkVTMyxcbiAgICAgICAgICAgICdlczUnOiBfdHMuU2NyaXB0VGFyZ2V0LkVTNSxcbiAgICAgICAgICAgICdlczYnOiBfdHMuU2NyaXB0VGFyZ2V0LkVTNixcbiAgICAgICAgfSxcbiAgICB9LFxuXTtcblxuY29uc3Qgb3B0aW9uc01hcDogX2xhbmcuTWFwPE9wdGlvbj4gPSBfbGFuZy5ncm91cEJ5KG9wdGlvbnNMaXN0LCAnbmFtZScpO1xuXG5jb25zdCBTX1RZUEVTQ1JJUFQgPSAndHlwZXNjcmlwdCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNvbXBpbGVyT3B0aW9ucyhjb25maWc6IE9iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlUGF0aDogUmVzb2x2ZVBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpZXI6IF91dGlsLk5vdGlmaWVyKTogX3RzLkNvbXBpbGVyT3B0aW9ucyB7XG4gICAgbGV0IG9wdGlvbnM6IF90cy5Db21waWxlck9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXG4gICAgX2xhbmcuZm9yRWFjaChjb25maWcsIChuYW1lLCB2YWx1ZSkgPT4ge1xuICAgICAgICBpZiAobmFtZSBpbiBvcHRpb25zTWFwKSB7XG4gICAgICAgICAgICBsZXQgb3B0aW9uID0gb3B0aW9uc01hcFtuYW1lXTtcbiAgICAgICAgICAgIGlmIChvcHRpb24udHlwZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBpZiAoIV9sYW5nLmlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBub3RpZmllci5ub3RpZnkoYEV4cGVjdGVkIHN0cmluZyB2YWx1ZSBvZiB0aGUgY29uZmlnIHByb3BlcnR5ICR7cShuYW1lKX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChvcHRpb24udHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICBpZiAoIV9sYW5nLmlzTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBub3RpZmllci5ub3RpZnkoYEV4cGVjdGVkIG51bWJlciB2YWx1ZSBvZiB0aGUgY29uZmlnIHByb3BlcnR5ICR7cShuYW1lKX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChvcHRpb24udHlwZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfbGFuZy5pc0Jvb2xlYW4odmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWVyLm5vdGlmeShgRXhwZWN0ZWQgYm9vbGVhbiB2YWx1ZSBvZiB0aGUgY29uZmlnIHByb3BlcnR5ICR7cShuYW1lKX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW4gPGFueT5vcHRpb24udHlwZSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG9wdGlvbi50eXBlW3ZhbHVlXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWVyLm5vdGlmeShgVW5rbm93biB2YWx1ZSAke3EodmFsdWUpfSBvZiB0aGUgY29uZmlnIHByb3BlcnR5ICR7cShuYW1lKX0sIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYGV4cGVjdGVkIG9uZSBvZiAke09iamVjdC5rZXlzKG9wdGlvbi50eXBlKS5tYXAocSkuam9pbignLCAnKX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb24uaXNGaWxlUGF0aCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gcmVzb2x2ZVBhdGgodmFsdWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBvcHRpb25zW25hbWVdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAobmFtZSAhPT0gU19UWVBFU0NSSVBUKSB7XG4gICAgICAgICAgICAgICAgbm90aWZpZXIubm90aWZ5KGBVbmtub3duIGNvbmZpZyBwcm9wZXJ0eSAke3EobmFtZSl9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChvcHRpb25zLnJvb3REaXIgPT0gbnVsbCkge1xuICAgICAgICBvcHRpb25zLnJvb3REaXIgPSByZXNvbHZlUGF0aCgnLicpO1xuICAgIH1cblxuICAgIHJldHVybiBvcHRpb25zO1xuXG4gICAgZnVuY3Rpb24gcShzOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYCcke3N9J2A7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9hZEFkYXB0ZXIoY29uZmlnOiBPYmplY3QpOiBfYWRhcHRlci5BZGFwdGVyIHtcbiAgICBpZiAoU19UWVBFU0NSSVBUIGluIGNvbmZpZykge1xuICAgICAgICBsZXQgdHMgPSBjb25maWdbU19UWVBFU0NSSVBUXTtcbiAgICAgICAgaWYgKCFfbGFuZy5pc09iamVjdCh0cykgfHwgIV9sYW5nLmlzU3RyaW5nKHRzLnZlcnNpb24pKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgVHlwZVNjcmlwdCBvcGJlY3QgaW4gdGhlIGNvbmZpZyBwcm9wZXJ0eSAndHlwZXNjcmlwdCdgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2FkYXB0ZXIubG9hZCh0cyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gX2FkYXB0ZXIubG9hZChfdHMpO1xuICAgIH1cbn1cbiJdfQ==